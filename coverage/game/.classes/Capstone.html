


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html id="htmlId">
<head>
  <title>Coverage Report :: Capstone</title>
  <style type="text/css">
    @import "../../.css/coverage.css";
  </style>
</head>

<body>
<div class="header"></div>

<div class="content">
<div class="breadCrumbs">
    [ <a href="../../index.html">all classes</a> ]
    [ <a href="../index.html">game</a> ]
</div>

<h1>Coverage Summary for Class: Capstone (game)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Capstone</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (22/ 22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    96.6%
  </span>
  <span class="absValue">
    (115/ 119)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Capstone$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/ 1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/ 1)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>total</strong></td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (23/ 23)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    96.7%
  </span>
  <span class="absValue">
    (116/ 120)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<div class="sourceCode"><i>1</i>&nbsp;package game;
<i>2</i>&nbsp;
<i>3</i>&nbsp;import game.battle.Battle;
<i>4</i>&nbsp;import game.character.*;
<i>5</i>&nbsp;import game.character.moves.Move;
<i>6</i>&nbsp;import game.character.moves.MoveSet;
<i>7</i>&nbsp;import game.gui.ButtonGrid;
<i>8</i>&nbsp;import game.gui.LabeledButton;
<i>9</i>&nbsp;import game.input.BattleCommandDelegate;
<i>10</i>&nbsp;import game.input.DemoInputHandler;
<i>11</i>&nbsp;import game.input.InputHandler;
<i>12</i>&nbsp;import org.newdawn.slick.*;
<i>13</i>&nbsp;import org.newdawn.slick.command.InputProvider;
<i>14</i>&nbsp;import org.newdawn.slick.fills.GradientFill;
<i>15</i>&nbsp;import org.newdawn.slick.geom.RoundedRectangle;
<i>16</i>&nbsp;import org.newdawn.slick.openal.Audio;
<i>17</i>&nbsp;import org.newdawn.slick.openal.SoundStore;
<i>18</i>&nbsp;
<i>19</i>&nbsp;import java.io.IOException;
<i>20</i>&nbsp;
<i>21</i>&nbsp;public class Capstone implements Game {
<b class="fc"><i>22</i>&nbsp;	private static Capstone instance = new Capstone(&quot;Capstone&quot;);</b>
<i>23</i>&nbsp;
<i>24</i>&nbsp;	private String title;
<b class="fc"><i>25</i>&nbsp;	private Image im = null;</b>
<b class="fc"><i>26</i>&nbsp;	private Animation anim = null;</b>
<b class="fc"><i>27</i>&nbsp;	private Audio bgm = null;</b>
<b class="fc"><i>28</i>&nbsp;	private InputProvider provider = null;</b>
<b class="fc"><i>29</i>&nbsp;	private DemoInputHandler handler = new DemoInputHandler();</b>
<i>30</i>&nbsp;
<b class="fc"><i>31</i>&nbsp;	private InputHandler input = new InputHandler();</b>
<i>32</i>&nbsp;	private MoveSet testMoveSet;
<i>33</i>&nbsp;	private Species testSpecies;
<i>34</i>&nbsp;	private Move punch;
<i>35</i>&nbsp;	private Move kick;
<i>36</i>&nbsp;	private Move slap;
<i>37</i>&nbsp;	private Move elbow;
<i>38</i>&nbsp;	private Move bite;
<i>39</i>&nbsp;	private Move slam;
<i>40</i>&nbsp;	private Player player;
<i>41</i>&nbsp;	private Move[] moves;
<i>42</i>&nbsp;	private Monster mon3;
<i>43</i>&nbsp;	private Monster mon2;
<i>44</i>&nbsp;	private Monster mon1;
<i>45</i>&nbsp;	private Battle demoBattle;
<i>46</i>&nbsp;	private BattleCommandDelegate battleCommandDelegate;
<i>47</i>&nbsp;	private SpriteSheet orcSheet;
<i>48</i>&nbsp;	private LabeledButton[] buttons;
<i>49</i>&nbsp;	private ButtonGrid moveGrid;
<i>50</i>&nbsp;	private PlayableCharacter[] actors;
<i>51</i>&nbsp;
<i>52</i>&nbsp;	/**
<i>53</i>&nbsp;	 * Create a new basic game
<i>54</i>&nbsp;	 *
<i>55</i>&nbsp;	 * @param title The title for the game
<i>56</i>&nbsp;	 */
<b class="fc"><i>57</i>&nbsp;	public Capstone(String title) {</b>
<b class="fc"><i>58</i>&nbsp;		this.title = title;</b>
<b class="fc"><i>59</i>&nbsp;	}</b>
<i>60</i>&nbsp;
<i>61</i>&nbsp;	/**
<i>62</i>&nbsp;	 * Initialise the game. This can be used to load static resources. It&#39;s called
<i>63</i>&nbsp;	 * before the game loop starts
<i>64</i>&nbsp;	 *
<i>65</i>&nbsp;	 * @param container The container holding the game
<i>66</i>&nbsp;	 * @throws SlickException Throw to indicate an internal error
<i>67</i>&nbsp;	 */
<i>68</i>&nbsp;	@Override
<i>69</i>&nbsp;	public void init(GameContainer container) throws SlickException {
<i>70</i>&nbsp;		// ##### TESTING CODE ##### //
<b class="fc"><i>71</i>&nbsp;		container.getInput().addPrimaryListener(input);</b>
<b class="fc"><i>72</i>&nbsp;		SoundStore.get().init();</b>
<b class="fc"><i>73</i>&nbsp;		container.setMusicOn(true);</b>
<b class="fc"><i>74</i>&nbsp;		container.setMusicVolume(5.0f);</b>
<i>75</i>&nbsp;		try {
<b class="fc"><i>76</i>&nbsp;			bgm = SoundStore.get().getOgg(&quot;assets/sound/bgm/FromHere.ogg&quot;);</b>
<b class="nc"><i>77</i>&nbsp;		} catch (IOException ioe) {</b>
<b class="nc"><i>78</i>&nbsp;			ioe.printStackTrace();</b>
<b class="fc"><i>79</i>&nbsp;		}</b>
<i>80</i>&nbsp;
<i>81</i>&nbsp;		//im = new Image(&quot;assets/image/doggo.png&quot;);
<i>82</i>&nbsp;		//SpriteSheet sprites = new SpriteSheet(&quot;assets/sprite/Ultravore.gif&quot;, 20, 20, 1);
<i>83</i>&nbsp;		//anim = new Animation(sprites, 0, 0, 8, 0, true, 1000, true);
<i>84</i>&nbsp;
<i>85</i>&nbsp;		// ##### PRODUCTION CODE ##### //
<b class="fc"><i>86</i>&nbsp;		initInput(container);</b>
<b class="fc"><i>87</i>&nbsp;		initMoves(container);</b>
<b class="fc"><i>88</i>&nbsp;		initSpecies(container);</b>
<b class="fc"><i>89</i>&nbsp;		initPlayer(container);</b>
<b class="fc"><i>90</i>&nbsp;		initDungeon(container);</b>
<b class="fc"><i>91</i>&nbsp;		initGUI(container);</b>
<i>92</i>&nbsp;
<i>93</i>&nbsp;		// ##### DEMO CODE ##### //
<b class="fc"><i>94</i>&nbsp;		actors = new PlayableCharacter[] { player, mon1, mon2, mon3 };</b>
<i>95</i>&nbsp;
<b class="fc"><i>96</i>&nbsp;		demoBattle.start(new IBattlable[] { player, mon1 }, new IBattlable[] { mon2, mon3 });</b>
<b class="fc"><i>97</i>&nbsp;		battleCommandDelegate.init(demoBattle);</b>
<b class="fc"><i>98</i>&nbsp;	}</b>
<i>99</i>&nbsp;
<i>100</i>&nbsp;	private void initInput(GameContainer container) {
<b class="fc"><i>101</i>&nbsp;		provider = new InputProvider(container.getInput());</b>
<b class="fc"><i>102</i>&nbsp;		provider.addListener(handler);</b>
<b class="fc"><i>103</i>&nbsp;		handler.registerCommands(provider);</b>
<b class="fc"><i>104</i>&nbsp;		battleCommandDelegate = new BattleCommandDelegate(container.getInput());</b>
<b class="fc"><i>105</i>&nbsp;		handler.addCommandDelegate(battleCommandDelegate);</b>
<b class="fc"><i>106</i>&nbsp;	}</b>
<i>107</i>&nbsp;
<i>108</i>&nbsp;	private void initMoves(GameContainer container) {
<b class="fc"><i>109</i>&nbsp;		punch = new Move(&quot;Punch&quot;, &quot;&quot;, 5, 80, 30);</b>
<b class="fc"><i>110</i>&nbsp;		kick = new Move(&quot;Kick&quot;, &quot;&quot;, 4, 90, 30);</b>
<b class="fc"><i>111</i>&nbsp;		slap = new Move(&quot;Slap&quot;, &quot;&quot;, 3, 100, 20);</b>
<b class="fc"><i>112</i>&nbsp;		elbow = new Move(&quot;Elbow&quot;, &quot;&quot;, 4, 85, 30);</b>
<b class="fc"><i>113</i>&nbsp;		bite = new Move(&quot;Bite&quot;, &quot;&quot;, 5, 90, 20);</b>
<b class="fc"><i>114</i>&nbsp;		slam = new Move(&quot;Slam&quot;, &quot;&quot;, 6, 80, 10);</b>
<b class="fc"><i>115</i>&nbsp;		testMoveSet = new MoveSet();</b>
<b class="fc"><i>116</i>&nbsp;		testMoveSet.putMove(punch, -1);</b>
<b class="fc"><i>117</i>&nbsp;		testMoveSet.putMove(kick, 2);</b>
<b class="fc"><i>118</i>&nbsp;		testMoveSet.putMove(slap, 4);</b>
<b class="fc"><i>119</i>&nbsp;		testMoveSet.putMove(elbow, 7);</b>
<b class="fc"><i>120</i>&nbsp;		testMoveSet.putMove(bite,11);</b>
<b class="fc"><i>121</i>&nbsp;		testMoveSet.putMove(slam,16);</b>
<b class="fc"><i>122</i>&nbsp;	}</b>
<i>123</i>&nbsp;
<i>124</i>&nbsp;	private void initSpecies(GameContainer container) {
<b class="fc"><i>125</i>&nbsp;		initSprites(container);</b>
<b class="fc"><i>126</i>&nbsp;		testSpecies = new Species(&quot;Test Uno&quot;, testMoveSet, orcSheet) {};</b>
<b class="fc"><i>127</i>&nbsp;	}</b>
<i>128</i>&nbsp;
<i>129</i>&nbsp;	private void initSprites(GameContainer container) {
<i>130</i>&nbsp;		try {
<b class="fc"><i>131</i>&nbsp;			orcSheet = new SpriteSheet(&quot;assets/sprite/orc/orc_regular_hair.png&quot;, 20, 20, 0);</b>
<b class="nc"><i>132</i>&nbsp;		} catch (SlickException e) {</b>
<b class="nc"><i>133</i>&nbsp;			e.printStackTrace();</b>
<b class="fc"><i>134</i>&nbsp;		}</b>
<b class="fc"><i>135</i>&nbsp;	}</b>
<i>136</i>&nbsp;
<i>137</i>&nbsp;	private void initPlayer(GameContainer container) {
<b class="fc"><i>138</i>&nbsp;		moves = new Move[] { punch, kick, slap, elbow, bite, slam };</b>
<b class="fc"><i>139</i>&nbsp;		player = new Player(testSpecies, new Stats(30, 5, 5, 4), moves, &quot;Player1&quot;);</b>
<b class="fc"><i>140</i>&nbsp;		mon1 = new Monster(testSpecies, new Stats(20, 4, 6, 3), moves);</b>
<b class="fc"><i>141</i>&nbsp;		player.addMonsterToParty(mon1);</b>
<b class="fc"><i>142</i>&nbsp;	}</b>
<i>143</i>&nbsp;
<i>144</i>&nbsp;	private void initDungeon(GameContainer container) {
<b class="fc"><i>145</i>&nbsp;		initMonsters();</b>
<b class="fc"><i>146</i>&nbsp;		initBoss();</b>
<i>147</i>&nbsp;
<b class="fc"><i>148</i>&nbsp;		demoBattle = new Battle(battleCommandDelegate);</b>
<b class="fc"><i>149</i>&nbsp;	}</b>
<i>150</i>&nbsp;
<i>151</i>&nbsp;	private void initMonsters() {
<b class="fc"><i>152</i>&nbsp;		mon2 = new Monster(testSpecies, new Stats(25, 3, 4, 2), moves);</b>
<b class="fc"><i>153</i>&nbsp;		mon3 = new Monster(testSpecies, new Stats(15, 5, 5, 5), moves);</b>
<b class="fc"><i>154</i>&nbsp;	}</b>
<i>155</i>&nbsp;
<i>156</i>&nbsp;	private void initBoss() {
<i>157</i>&nbsp;
<b class="fc"><i>158</i>&nbsp;	}</b>
<i>159</i>&nbsp;
<i>160</i>&nbsp;	private void initGUI(GameContainer container) {
<b class="fc"><i>161</i>&nbsp;		buttons = new LabeledButton[PlayableCharacter.MAX_MOVES];</b>
<b class="fc"><i>162</i>&nbsp;		for (int i = 0; i &lt; PlayableCharacter.MAX_MOVES; i++) {</b>
<b class="fc"><i>163</i>&nbsp;			buttons[i] = new LabeledButton(moves[i], battleCommandDelegate, container, container.getDefaultFont(), null, new RoundedRectangle(0,0,200,container.getDefaultFont().getLineHeight()+10, 8));</b>
<i>164</i>&nbsp;		}
<b class="fc"><i>165</i>&nbsp;		moveGrid = new ButtonGrid(container, 1, 6, 5, buttons);</b>
<b class="fc"><i>166</i>&nbsp;	}</b>
<i>167</i>&nbsp;
<i>168</i>&nbsp;	/**
<i>169</i>&nbsp;	 * Update the game logic here. No rendering should take place in this method
<i>170</i>&nbsp;	 * though it won&#39;t do any harm.
<i>171</i>&nbsp;	 *
<i>172</i>&nbsp;	 * @param container The container holing this game
<i>173</i>&nbsp;	 * @param delta     The amount of time thats passed since last update in milliseconds
<i>174</i>&nbsp;	 * @throws SlickException Throw to indicate an internal error
<i>175</i>&nbsp;	 */
<i>176</i>&nbsp;	@Override
<i>177</i>&nbsp;	public void update(GameContainer container, int delta) throws SlickException {
<i>178</i>&nbsp;		// ##### TESTING CODE ##### //
<b class="fc"><i>179</i>&nbsp;		int bufid = -1;</b>
<b class="fc"><i>180</i>&nbsp;		if (!bgm.isPlaying()) {</b>
<i>181</i>&nbsp;			//bufid = bgm.playAsMusic(1.0f, 0.05f, false);
<i>182</i>&nbsp;		}
<i>183</i>&nbsp;
<i>184</i>&nbsp;		// ##### PRODUCTION CODE ##### //
<i>185</i>&nbsp;
<i>186</i>&nbsp;		// ##### DEMO CODE ##### //
<b class="fc"><i>187</i>&nbsp;		if (demoBattle.isOver()) {</b>
<b class="fc"><i>188</i>&nbsp;			handler.removeCommandDelegate(battleCommandDelegate);</b>
<i>189</i>&nbsp;		}
<b class="fc"><i>190</i>&nbsp;	}</b>
<i>191</i>&nbsp;
<i>192</i>&nbsp;	/**
<i>193</i>&nbsp;	 * Render the game&#39;s screen here.
<i>194</i>&nbsp;	 *
<i>195</i>&nbsp;	 * @param container The container holing this game
<i>196</i>&nbsp;	 * @param g         The graphics context that can be used to render. However, normal rendering
<i>197</i>&nbsp;	 *                  routines can also be used.
<i>198</i>&nbsp;	 * @throws SlickException Throw to indicate a internal error
<i>199</i>&nbsp;	 */
<i>200</i>&nbsp;	@Override
<i>201</i>&nbsp;	public void render(GameContainer container, Graphics g) throws SlickException {
<i>202</i>&nbsp;		// ##### TESTING CODE ##### //
<b class="fc"><i>203</i>&nbsp;		g.drawString(&quot;Welcome to our Capstone!&quot;,980,20);</b>
<i>204</i>&nbsp;		//g.drawImage(im, 10+input.getxOff(), 120+input.getyOff());
<i>205</i>&nbsp;		//g.drawAnimation(anim, 10, 30);
<b class="fc"><i>206</i>&nbsp;		if (demoBattle.isOver()) {</b>
<b class="fc"><i>207</i>&nbsp;			g.drawString(demoBattle.playerVictory() ? &quot;You WIN!&quot; : &quot;You LOSE!&quot;, 240, 40);</b>
<i>208</i>&nbsp;		} else {
<b class="fc"><i>209</i>&nbsp;			g.drawString(&quot;Keep on battling!&quot;, 140,40);</b>
<i>210</i>&nbsp;		}
<i>211</i>&nbsp;
<i>212</i>&nbsp;		// ##### PRODUCTION CODE ##### //
<b class="fc"><i>213</i>&nbsp;		g.setBackground(Color.darkGray);</b>
<b class="fc"><i>214</i>&nbsp;		g.setAntiAlias(true);</b>
<b class="fc"><i>215</i>&nbsp;		g.setLineWidth(2.0f);</b>
<i>216</i>&nbsp;
<b class="fc"><i>217</i>&nbsp;		drawHUD(container, g);</b>
<b class="fc"><i>218</i>&nbsp;		drawBattle(container, g);</b>
<b class="fc"><i>219</i>&nbsp;		Animation deathAnim = mon2.getDeathAnimation();</b>
<b class="fc"><i>220</i>&nbsp;		if (deathAnim != null) {</b>
<b class="fc"><i>221</i>&nbsp;			deathAnim.setLooping(false);</b>
<b class="fc"><i>222</i>&nbsp;			g.drawAnimation(deathAnim, 20, 200);</b>
<i>223</i>&nbsp;			//deathAnim.setDuration(0, 2000);
<i>224</i>&nbsp;		}
<b class="fc"><i>225</i>&nbsp;	}</b>
<i>226</i>&nbsp;
<i>227</i>&nbsp;	private void drawHUD(GameContainer container, Graphics g) throws SlickException {
<b class="fc"><i>228</i>&nbsp;		drawStats(container, g);</b>
<b class="fc"><i>229</i>&nbsp;		drawMoves(container, g);</b>
<b class="fc"><i>230</i>&nbsp;	}</b>
<i>231</i>&nbsp;
<i>232</i>&nbsp;	private void drawStats(GameContainer container, Graphics g) {
<b class="fc"><i>233</i>&nbsp;		g.setColor(Color.lightGray);</b>
<b class="fc"><i>234</i>&nbsp;		int x = 20, y = 20;</b>
<b class="fc"><i>235</i>&nbsp;		for (PlayableCharacter actor : actors) {</b>
<b class="fc"><i>236</i>&nbsp;			float w = ( (actor.HP() * 1.0f) / actor.getStats().maxHP() );</b>
<i>237</i>&nbsp;			//g.setColor(Color.lightGray);
<b class="fc"><i>238</i>&nbsp;			g.fillRoundRect(x-2, y-2, 204, 24, 8);</b>
<b class="fc"><i>239</i>&nbsp;			g.fill(new RoundedRectangle(x, y, w*200, 20, 8), new GradientFill(x,y,Color.red, x+200,y+20,Color.green));</b>
<b class="fc"><i>240</i>&nbsp;			y += 35;</b>
<i>241</i>&nbsp;		}
<i>242</i>&nbsp;
<b class="fc"><i>243</i>&nbsp;		IBattlable active = demoBattle.getActiveActor();</b>
<b class="fc"><i>244</i>&nbsp;		x = 240;</b>
<b class="fc"><i>245</i>&nbsp;		y = 60;</b>
<b class="fc"><i>246</i>&nbsp;		for (PlayableCharacter actor : actors) {</b>
<b class="fc"><i>247</i>&nbsp;			Color color = (actor == active) ? Color.white : Color.lightGray;</b>
<b class="fc"><i>248</i>&nbsp;			g.getFont().drawString(x, y, actor.getName()+&quot; HP: &quot;+actor.HP(), color);</b>
<b class="fc"><i>249</i>&nbsp;			y += 20;</b>
<i>250</i>&nbsp;		}
<b class="fc"><i>251</i>&nbsp;	}</b>
<i>252</i>&nbsp;
<i>253</i>&nbsp;	private void drawMoves(GameContainer container, Graphics g) throws SlickException {
<b class="fc"><i>254</i>&nbsp;		moveGrid.setLocation(20, container.getHeight()-(moveGrid.getHeight()+20));</b>
<b class="fc"><i>255</i>&nbsp;		moveGrid.render(container, g);</b>
<b class="fc"><i>256</i>&nbsp;	}</b>
<i>257</i>&nbsp;
<i>258</i>&nbsp;	private void drawBattle(GameContainer container, Graphics g) {
<i>259</i>&nbsp;
<b class="fc"><i>260</i>&nbsp;	}</b>
<i>261</i>&nbsp;
<i>262</i>&nbsp;	/**
<i>263</i>&nbsp;	 * Notification that a game close has been requested
<i>264</i>&nbsp;	 *
<i>265</i>&nbsp;	 * @return True if the game should close
<i>266</i>&nbsp;	 */
<i>267</i>&nbsp;	@Override
<i>268</i>&nbsp;	public boolean closeRequested() {
<b class="fc"><i>269</i>&nbsp;		return true;</b>
<i>270</i>&nbsp;	}
<i>271</i>&nbsp;
<i>272</i>&nbsp;	/**
<i>273</i>&nbsp;	 * Get the title of this game
<i>274</i>&nbsp;	 *
<i>275</i>&nbsp;	 * @return The title of the game
<i>276</i>&nbsp;	 */
<i>277</i>&nbsp;	@Override
<i>278</i>&nbsp;	public String getTitle() {
<b class="fc"><i>279</i>&nbsp;		return this.title;</b>
<i>280</i>&nbsp;	}
<i>281</i>&nbsp;
<i>282</i>&nbsp;	public LabeledButton[] getButtons(){
<b class="fc"><i>283</i>&nbsp;		return this.buttons;</b>
<i>284</i>&nbsp;	}
<i>285</i>&nbsp;
<i>286</i>&nbsp;	public static Capstone getInstance() {
<b class="fc"><i>287</i>&nbsp;		return instance;</b>
<i>288</i>&nbsp;	}
<i>289</i>&nbsp;}
<i>290</i>&nbsp;
</div>
</div>

<div class="footer">
    
    <div style="float:right;">generated on 2018-06-26 11:55</div>
</div>
</body>
</html>
